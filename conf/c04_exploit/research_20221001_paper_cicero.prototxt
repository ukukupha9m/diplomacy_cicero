includes { path: "rollouters/best_agent_20220405_rl_rollouts"; mount: "search_rollout.agent" }
includes { path: "opponents/searchbot_20210501_translite_rol0"; mount: "search_rollout.h2h_eval_0" }
includes { path: "opponents/searchbot_20210501_translite_rol0"; mount: "search_rollout.h2h_eval_1" }
includes { path: "launcher/slurm_8gpus32gb_diplomacy.prototxt"; mount: "launcher" }
exploit {
    model_path: "models/human_imitation_joint_policy_for_rl.ckpt"
    value_model_path: "models/human_sl_value_function.ckpt"

    critic_weight: 1.0

    discounting: 1.0
    search_policy_weight: 0.1
    num_train_gpus: 4
    bootstrap_offline_targets: true
    use_distributed_data_parallel: true
    single_power_chances: 0.5
    six_power_chances: 0.5
    optimizer {
        adam {
            lr: 1e-4
        }
        grad_clip: 0.5
        warmup_epochs: 100
    }
    power_conditioning {
      prob: 0.5
      min_num_power: 1
      max_num_power: 2
    }
    search_rollout {
        agent {
            best_agent {
                plausible_orders_cfg {
                    max_actions_units_ratio: 6.0
                }
                rollouts_cfg {
                    year_spring_prob_of_ending: "1901,0;1909,1.0"
                }
            }
        }
        extra_params {
            explore_eps: 0.0
            independent_explore: true
            use_ev_targets: true
            use_cfr_evs: true
            allow_policy_tragets_without_do: true
            use_trained_policy: true
            use_trained_value: true
            default_has_press: true
            max_policy_size: 50
        }
        chunk_length: 128
        batch_size: 8
        warmup_batches: 200
        num_workers_per_gpu: 4
        num_cores_to_reserve: 70
        draw_on_stalemate_years: 3
        enforce_train_gen_ratio: 9
        linear_average_sync_policy_checkpoints: true
        buffer {
            shuffle: 1
            prefetch: 5
            capacity: 10000
        }
        test_situation_eval {
            do_eval: false
        }
        h2h_eval_1 {
            tag: "fastbot_translite_rol0_inverse"
            play_as_six: true
        }
    }
    trainer {
        max_epochs: 3001
        epoch_size: 100
        save_checkpoint_every: 100
        save_sync_checkpoint_every: 40
    }
    launcher {
        slurm {
            num_gpus: 248
        }
    }
}
